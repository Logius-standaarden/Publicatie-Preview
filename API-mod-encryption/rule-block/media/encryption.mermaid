graph TD
    Request--"JSON(payload)"-->SignA
    SignA--"JWE(JSON(payload))"-->SignB
    SignB--"JSON(payload)"-->Proc
    Proc--"JSON(payload)"-->SignC
    SignC--"JWE(JSON(payload))"-->SignD
    SignD--"JSON(payload)"-->Response

    direction TB
    subgraph Service Provider
    direction TB
    SignB(Decrypt with Provider private key )
    Proc(Process Request)
    SignC(Encrypt with Requester public key)  

    end

    subgraph Service Requester
    direction TB
    Request:::sc
    SignA(Encrypt with Provider public key)
    SignD(Decrypt with Requester private key )

   classDef sc fill:#f96
    Response:::sc
    end
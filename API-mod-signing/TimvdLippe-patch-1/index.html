<!DOCTYPE html><html lang="en"><head>
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
<meta content="text/html; charset=utf-8" http-equiv="content-type">
<meta name="generator" content="ReSpec 35.4.1">
<style>
dfn{cursor:pointer}
.dfn-panel{position:absolute;z-index:35;min-width:300px;max-width:500px;padding:.5em .75em;margin-top:.6em;font-family:"Helvetica Neue",sans-serif;font-size:small;background:#fff;background:var(--indextable-hover-bg,#fff);color:#000;color:var(--text,#000);box-shadow:0 1em 3em -.4em rgba(0,0,0,.3),0 0 1px 1px rgba(0,0,0,.05);box-shadow:0 1em 3em -.4em var(--tocsidebar-shadow,rgba(0,0,0,.3)),0 0 1px 1px var(--tocsidebar-shadow,rgba(0,0,0,.05));border-radius:2px}
.dfn-panel:not(.docked)>.caret{position:absolute;top:-9px}
.dfn-panel:not(.docked)>.caret::after,.dfn-panel:not(.docked)>.caret::before{content:"";position:absolute;border:10px solid transparent;border-top:0;border-bottom:10px solid #fff;border-bottom-color:var(--indextable-hover-bg,#fff);top:0}
.dfn-panel:not(.docked)>.caret::before{border-bottom:9px solid #a2a9b1;border-bottom-color:var(--indextable-hover-bg,#a2a9b1)}
.dfn-panel *{margin:0}
.dfn-panel b{display:block;color:#000;color:var(--text,#000);margin-top:.25em}
.dfn-panel ul a[href]{color:#333;color:var(--text,#333)}
.dfn-panel>div{display:flex}
.dfn-panel a.self-link{font-weight:700;margin-right:auto}
.dfn-panel .marker{padding:.1em;margin-left:.5em;border-radius:.2em;text-align:center;white-space:nowrap;font-size:90%;color:#040b1c}
.dfn-panel .marker.dfn-exported{background:#d1edfd;box-shadow:0 0 0 .125em #1ca5f940}
.dfn-panel .marker.idl-block{background:#8ccbf2;box-shadow:0 0 0 .125em #0670b161}
.dfn-panel a:not(:hover){text-decoration:none!important;border-bottom:none!important}
.dfn-panel a[href]:hover{border-bottom-width:1px}
.dfn-panel ul{padding:0}
.dfn-panel li{margin-left:1em}
.dfn-panel.docked{position:fixed;left:.5em;top:unset;bottom:2em;margin:0 auto;max-width:calc(100vw - .75em * 2 - .5em - .2em * 2);max-height:30vh;overflow:auto}
</style>
  
  
  
<meta name="color-scheme" content="light dark">
  
<title>API Design Rules Module: Signing</title>
  
<link href="https://gitdocumentatie.logius.nl/publicatie/respec/style/nlgov/adr-style.css" rel="stylesheet" type="text/css">
  
<link href="https://gitdocumentatie.logius.nl/publicatie/respec/style/nlgov/adr-dark.css" rel="stylesheet" type="text/css" media="(prefers-color-scheme: dark)">
  
<link href="https://gitdocumentatie.logius.nl/publicatie/respec/style/logos/logius.ico" rel="shortcut icon" type="image/x-icon">
  

<style id="respec-mainstyle">
@keyframes pop{
0%{transform:scale(1,1)}
25%{transform:scale(1.25,1.25);opacity:.75}
100%{transform:scale(1,1)}
}
a.internalDFN{color:inherit;border-bottom:1px solid #99c;text-decoration:none}
a.externalDFN{color:inherit;border-bottom:1px dotted #ccc;text-decoration:none}
a.bibref{text-decoration:none}
.respec-offending-element:target{animation:pop .25s ease-in-out 0s 1}
.respec-offending-element,a[href].respec-offending-element{text-decoration:red wavy underline}
@supports not (text-decoration:red wavy underline){
.respec-offending-element:not(pre){display:inline-block}
.respec-offending-element{background:url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=) bottom repeat-x}
}
#references :target{background:#eaf3ff;animation:pop .4s ease-in-out 0s 1}
cite .bibref{font-style:italic}
a[href].orcid{padding-left:4px;padding-right:4px}
a[href].orcid>svg{margin-bottom:-2px}
ol.tof,ul.tof{list-style:none outside none}
.caption{margin-top:.5em;font-style:italic}
#issue-summary>ul{column-count:2}
#issue-summary li{list-style:none;display:inline-block}
details.respec-tests-details{margin-left:1em;display:inline-block;vertical-align:top}
details.respec-tests-details>*{padding-right:2em}
details.respec-tests-details[open]{z-index:999999;position:absolute;border:thin solid #cad3e2;border-radius:.3em;background-color:#fff;padding-bottom:.5em}
details.respec-tests-details[open]>summary{border-bottom:thin solid #cad3e2;padding-left:1em;margin-bottom:1em;line-height:2em}
details.respec-tests-details>ul{width:100%;margin-top:-.3em}
details.respec-tests-details>li{padding-left:1em}
.self-link:hover{opacity:1;text-decoration:none;background-color:transparent}
aside.example .marker>a.self-link{color:inherit}
.header-wrapper{display:flex;align-items:baseline;position:relative;left:-.5em}
:is(h2,h3,h4,h5,h6):not(#toch2)+a.self-link{color:inherit;order:-1;position:relative;left:-.7em;font-size:1rem;opacity:.5}
:is(h2,h3,h4,h5,h6)+a.self-link::before{content:"§";text-decoration:none;color:var(--heading-text)}
:is(h2,h3)+a.self-link{top:-.2em}
:is(h4,h5,h6)+a.self-link::before{color:#000}
@media (max-width:767px){
dd{margin-left:0}
}
@media print{
.removeOnSave{display:none}
}
</style>
<style id="respec-nlgov">
img.license{float:left;padding-right:5px;background:0 0}
</style>
<meta name="description" content="This document is part of the Nederlandse API Strategie.">
<style>
.hljs{--base:#fafafa;--mono-1:#383a42;--mono-2:#686b77;--mono-3:#717277;--hue-1:#0b76c5;--hue-2:#336ae3;--hue-3:#a626a4;--hue-4:#42803c;--hue-5:#ca4706;--hue-5-2:#c91243;--hue-6:#986801;--hue-6-2:#9a6a01}
@media (prefers-color-scheme:dark){
.hljs{--base:#282c34;--mono-1:#abb2bf;--mono-2:#818896;--mono-3:#5c6370;--hue-1:#56b6c2;--hue-2:#61aeee;--hue-3:#c678dd;--hue-4:#98c379;--hue-5:#e06c75;--hue-5-2:#be5046;--hue-6:#d19a66;--hue-6-2:#e6c07b}
}
.hljs{display:block;overflow-x:auto;padding:.5em;color:#383a42;color:var(--mono-1,#383a42);background:#fafafa;background:var(--base,#fafafa)}
.hljs-comment,.hljs-quote{color:#717277;color:var(--mono-3,#717277);font-style:italic}
.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4;color:var(--hue-3,#a626a4)}
.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#ca4706;color:var(--hue-5,#ca4706);font-weight:700}
.hljs-literal{color:#0b76c5;color:var(--hue-1,#0b76c5)}
.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#42803c;color:var(--hue-4,#42803c)}
.hljs-built_in,.hljs-class .hljs-title{color:#9a6a01;color:var(--hue-6-2,#9a6a01)}
.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801;color:var(--hue-6,#986801)}
.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#336ae3;color:var(--hue-2,#336ae3)}
.hljs-emphasis{font-style:italic}
.hljs-strong{font-weight:700}
.hljs-link{text-decoration:underline}
</style>
<style>

  .sidelabel {
    position: fixed;
    -webkit-transform-origin: top right;
    right: 100%;
    top: 0;
    -webkit-transform: rotate(-90deg);
    padding: 4px 50px 4px 10px;
    color: white;
    white-space: nowrap;
    z-index: 1;
    background-color: #39870c;
  }
</style>
<script id="initialUserConfig" type="application/json">{
  "nl_organisationName": "Logius",
  "nl_organisationStylesURL": "https://gitdocumentatie.logius.nl/publicatie/respec/style/",
  "nl_organisationPublishURL": "https://gitdocumentatie.logius.nl/publicatie/",
  "logos": [
    {
      "src": "https://gitdocumentatie.logius.nl/publicatie/respec/style/logos/figure-logius.svg",
      "alt": "Logius",
      "id": "Logius",
      "height": 77,
      "width": 44,
      "url": "https://www.logius.nl/onze-dienstverlening/standaarden"
    }
  ],
  "useLogo": true,
  "fileName": "",
  "latestVersion": "https://logius-standaarden.github.io/API-mod-signing/",
  "thisVersion": [
    "nl_organisationPublishURL",
    "pubDomain",
    "/",
    "shortName",
    "/",
    "publishVersion",
    "/",
    "fileName"
  ],
  "prevVersion": [],
  "addSectionLinks": true,
  "localizationStrings": {
    "en": {
      "wv": "Draft",
      "cv": "Consultation version",
      "vv": "Proposed version",
      "def": "Definitive version",
      "basis": "Document",
      "eo": "Outdated version",
      "tg": "Rescinded version",
      "no": "Norm",
      "st": "Standard",
      "im": "Information model",
      "pr": "Guideline",
      "hr": "Guide",
      "wa": "Proposed recommendation",
      "al": "General",
      "bd": "Governance documentation",
      "bp": "Best practice"
    },
    "nl": {
      "wv": "Werkversie",
      "cv": "Consultatieversie",
      "vv": "Versie ter vaststelling",
      "def": "Vastgestelde versie",
      "basis": "Document",
      "eo": "Verouderde versie",
      "tg": "Teruggetrokken versie",
      "no": "Norm",
      "st": "Standaard",
      "im": "Informatiemodel",
      "pr": "Praktijkrichtlijn",
      "hr": "Handreiking",
      "wa": "Werkafspraak",
      "al": "Algemeen",
      "bd": "Beheerdocumentatie",
      "bp": "Best practice"
    }
  },
  "sotdText": {
    "nl": {
      "sotd": "Status van dit document",
      "def": "Dit is de definitieve versie van dit document. Wijzigingen naar aanleiding van consultaties zijn doorgevoerd.",
      "wv": "Dit is een werkversie die op elk moment kan worden gewijzigd, verwijderd of vervangen door andere documenten. Het is geen door het TO goedgekeurde consultatieversie.",
      "cv": "Dit is een door het TO goedgekeurde consultatieversie. Commentaar over dit document kan gestuurd worden naar digikoppeling@logius.nl",
      "vv": "Dit is een definitief concept van de nieuwe versie van dit document. Wijzigingen naar aanleiding van consultaties zijn doorgevoerd.",
      "basis": "Dit is een document zonder officiële status."
    },
    "en": {
      "sotd": "Status of This Document",
      "def": "This is the definitive version of this document. Edits resulting from consultations have been applied.",
      "wv": "This is a draft that could be altered, removed or replaced by other documents. It is not a recommendation approved by TO.",
      "cv": "This is a proposed recommendation approved by TO. Comments regarding this document may be sent to api@logius.nl",
      "vv": "This is the definitive concept of this document. Edits resulting from consultations have been applied.",
      "basis": "This document has no official standing."
    }
  },
  "labelColor": {
    "def": "#154273",
    "wv": "#39870c",
    "cv": "#000000",
    "vv": "#000000"
  },
  "useLabel": true,
  "licenses": {
    "cc0": {
      "name": "Creative Commons 0 Public Domain Dedication",
      "short": "CC0",
      "url": "https://creativecommons.org/publicdomain/zero/1.0/",
      "image": "https://gitdocumentatie.logius.nl/publicatie/respec/media/logos/cc-zero.svg"
    },
    "cc-by": {
      "name": "Creative Commons Attribution 4.0 International Public License",
      "short": "CC-BY",
      "url": "https://creativecommons.org/licenses/by/4.0/legalcode",
      "image": "https://gitdocumentatie.logius.nl/publicatie/respec/media/logos/cc-by.svg"
    },
    "cc-by-nd": {
      "name": "Creative Commons Naamsvermelding-GeenAfgeleideWerken 4.0 Internationaal",
      "short": "CC-BY-ND",
      "url": "https://creativecommons.org/licenses/by-nd/4.0/legalcode.nl",
      "image": "https://gitdocumentatie.logius.nl/publicatie/respec/media/logos/cc-by-nd.svg"
    }
  },
  "license": "cc-by",
  "localBiblio": {
    "ADR": {
      "authors": [
        "Jasper Roes",
        "Joost Farla"
      ],
      "href": "https://gitdocumentatie.logius.nl/publicatie/api/adr/2.0",
      "publisher": "Logius",
      "title": "API Design Rules"
    },
    "ADR1": {
      "authors": [
        "Jasper Roes",
        "Joost Farla"
      ],
      "href": "https://gitdocumentatie.logius.nl/publicatie/api/adr/1.0",
      "publisher": "Logius",
      "title": "API Design Rules"
    },
    "ADR-ext": {
      "authors": [
        "Jasper Roes",
        "Linda van den Brink"
      ],
      "date": "Januari 2020",
      "href": "https://docs.geostandaarden.nl/api/API-Strategie-ext",
      "publisher": "Geonovum/Kennisplatform APi's",
      "title": "API Designrules Extensions (Nederlandse API Strategie IIb)"
    },
    "Algemene Voorwaarden Logius": {
      "date": "12 juni 2018",
      "href": "https://www.logius.nl/onze-organisatie/zakendoen-met-logius/voorwaarden/algemene-voorwaarden-logius",
      "publisher": "Logius",
      "title": "Algemene voorwaarden Logius"
    },
    "AuthZEN": {
      "date": "6 September 2024 ",
      "href": "https://openid.net/specs/authorization-api-1_0-01.html",
      "publisher": "OpenID",
      "title": "Authorization API 1.0 – draft 01"
    },
    "AVG": {
      "date": "27 april 2016",
      "href": "https://eur-lex.europa.eu/legal-content/NL/TXT/?uri=CELEX%3A32016R0679",
      "publisher": "Verordening (EU) 2016/679 van het Europees Parlement",
      "title": "Algemene Verordening Gegevensbescherming"
    },
    "BCP195": {
      "authors": [
        "Y. Sheffer",
        "R. Holz",
        "P. Saint-Andre"
      ],
      "date": "May 2015",
      "href": "https://tools.ietf.org/html/bcp195",
      "publisher": "IETF",
      "title": "Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"
    },
    "DK-beveiliging": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/dk/beveilig/",
      "publisher": "Logius",
      "title": "Digikoppeling Beveiligingsstandaarden en voorschriften"
    },
    "CloudEvents": {
      "authors": [
        "@@@"
      ],
      "date": "May 2011",
      "href": "https://github.com/cloudevents/spec/blob/v1.0.1/spec.md",
      "publisher": "@@@",
      "title": "CloudEvents - Version 1.0.1"
    },
    "NLGOV-CloudEvents": {
      "authors": [
        "Werkgroep Berichtenstandaard (Project Notificatieservices)"
      ],
      "href": "https://logius-standaarden.github.io/NL-GOV-profile-for-CloudEvents/",
      "publisher": "Logius",
      "title": "NL GOV profile for CloudEvents"
    },
    "DK-CV": {
      "href": "https://gitlab.com/logius/digikoppeling-compliance",
      "publisher": "Logius",
      "title": "Digikoppeling Compliance Voorziening"
    },
    "DK-Portaal": {
      "href": "https://oinregister.logius.nl/",
      "publisher": "Logius",
      "title": "Digikoppeling Portaal"
    },
    "DK-WUS-voorbeeld": {
      "href": "https://www.logius.nl/sites/default/files/public/bestanden/diensten/DigiKoppeling/Overig/Digikoppeling-Koppelvlakstandaard-WUS-Voorbeeldberichten.zip",
      "publisher": "Logius",
      "title": "Set voorbeeldberichten (zip)"
    },
    "Deployment Guide 1.1": {
      "authors": [
        "Pete Wenzel",
        "Jacques Durand"
      ],
      "date": "June 2005",
      "href": "http://www.oasis-open.org/apps/org/workgroup/ebxml-iic-deployment-profile-template-intro-100406.doc",
      "publisher": "OASIS",
      "title": "Deployment Profile Template For OASIS ebXML Message Service 2.0"
    },
    "DK": {
      "href": "https://www.logius.nl/domeinen/gegevensuitwisseling/digikoppeling",
      "publisher": "Logius",
      "title": "Logius | Digikoppeling"
    },
    "DK-Doc": {
      "href": "https://www.logius.nl/domeinen/gegevensuitwisseling/digikoppeling/documentatie",
      "publisher": "Logius",
      "title": "Digikoppeling documentatie"
    },
    "DK-Beheermodel": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/dk/beheer/",
      "publisher": "Logius",
      "title": "Digikoppeling Beheermodel"
    },
    "DK-BPebMS": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/dk/bpebms/",
      "publisher": "Logius",
      "title": "Digikoppeling Best Practices ebMS2"
    },
    "DK-BPGB": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/dk/bpgb/",
      "publisher": "Logius",
      "title": "Digikoppeling Best Practices Grote Berichten"
    },
    "DK-BPWUS": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/dk/bpwus/",
      "publisher": "Logius",
      "title": "Digikoppeling Best Practices WUS"
    },
    "DK-Beveiliging": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/dk/beveilig/",
      "publisher": "Logius",
      "title": "Digikoppeling Beveiligingsstandaarden en voorschriften"
    },
    "DK-gbachtcert": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/dk/ebms/",
      "publisher": "Logius",
      "title": "Digikoppeling Koppelvlakstandaard ebMS2"
    },
    "DK-ebMS": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/dk/ebms/",
      "publisher": "Logius",
      "title": "Digikoppeling Koppelvlakstandaard ebMS2"
    },
    "DK-GB": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/dk/gb/",
      "publisher": "Logius",
      "title": "Digikoppeling Koppelvlakstandaard Grote Berichten"
    },
    "DK-WUS": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/dk/wus/",
      "publisher": "Logius",
      "title": "Digikoppeling Koppelvlakstandaard WUS"
    },
    "DK-RESTAPI": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/dk/restapi/",
      "publisher": "Logius",
      "title": "Digikoppeling Koppelvlakstandaard REST-API"
    },
    "DK-Architectuur": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/dk/architectuur/",
      "publisher": "Logius",
      "title": "Digikoppeling Architectuur"
    },
    "DK-IDAuth": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/dk/idauth/",
      "publisher": "Logius",
      "title": "Digikoppeling Identificatie en Authenticatie"
    },
    "DK-WI": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/dk/watisdk/",
      "publisher": "Logius",
      "title": "Wat is Digikoppeling?"
    },
    "BOMOSFundament": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/bomos/fundament/",
      "date": "2 november 2023",
      "publisher": "Logius",
      "title": "BOMOS, het fundament"
    },
    "BOMOSVerdieping": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/bomos/verdieping/",
      "date": "2 november 2023",
      "publisher": "Logius",
      "title": "BOMOS, de verdieping"
    },
    "ebCPP": {
      "authors": [
        "Oasis"
      ],
      "date": "september 2002",
      "href": "http://www.ebxml.org/specs/ebcpp-2.0.pdf",
      "publisher": "Oasis",
      "title": "Collaboration-Protocol Profile and Agreement Specification Version 2.0"
    },
    "ebMS3": {
      "authors": [
        "Ian Jones",
        "Pete Wenzel"
      ],
      "date": "October 2007",
      "href": "https://docs.oasis-open.org/ebxml-msg/ebms/v3.0/core/os/ebms_core-3.0-spec-os.html",
      "publisher": "Oasis",
      "title": "Collaboration-Protocol Profile and Agreement Specification Version 2.0"
    },
    "eDelivery API4IPS": {
      "authors": [
        "J. Dimitriou, V. Veduta, B. Dumitriu"
      ],
      "date": "sept 8 2022",
      "href": "https://ec.europa.eu/digital-building-blocks/wikis/display/EDELCOMMUNITY/Project+deliverables",
      "publisher": "OpenID foundation",
      "title": "(ISA2).(eDelivery).(Piloting a REST API extension of CEF eDelivery).(ISA² IPS REST API Profile).(v1.0).pdf"
    },
    "Expert": {
      "authors": [
        "@@@"
      ],
      "date": "@@@",
      "href": "https://www.forumstandaardisatie.nl/sites/bfs/files/@@@.pdf",
      "publisher": "Forum Standaardisatie",
      "title": "Expertadvies CloudEvents 1.0"
    },
    "folmer2011": {
      "href": "https://research.utwente.nl/en/publications/management-and-development-model-for-open-standards-bomos-version",
      "title": "Management and Development Model for Open Standards (BOMOS) version 2",
      "keywords": "IR-76837",
      "authors": [
        "ErwinFolmer",
        "Matthijs Punter"
      ],
      "date": "2011",
      "language": "English",
      "publisher": "Programmabureau NOiV"
    },
    "folmer2012": {
      "href": "https://research.utwente.nl/en/publications/quality-of-semantic-standards",
      "title": "Quality of Semantic Standards",
      "authors": [
        "Erwin Folmer"
      ],
      "date": "2012",
      "publisher": "Universiteit Twente"
    },
    "DK-Gebruiksvoorwaarden": {
      "date": "1 januari 2021",
      "href": "https://www.logius.nl/domeinen/gegevensuitwisseling/digikoppeling/documentatie/gebruiksvoorwaarden-digikoppeling",
      "publisher": "Logius",
      "title": "Gebruiksvoorwaarden Digikoppeling"
    },
    "ADR-GEO": {
      "authors": [
        "L. van den Brink, P. Bresters, P. van Genuchten, G. Mathijssen, M. Strijker"
      ],
      "date": "March 07, 2024",
      "href": "https://gitdocumentatie.logius.nl/publicatie/api/mod-geo/",
      "publisher": "Geonovum",
      "title": "API Design Rules Module: Geospatial"
    },
    "HTTPS-factsheet NCSC": {
      "date": "Nov 2014",
      "href": "https://www.ncsc.nl/documenten/factsheets/2019/juni/01/factsheet-https-kan-een-stuk-veiliger",
      "publisher": "NCSC",
      "title": "Factsheet HTTPS kan een stuk veiliger"
    },
    "iGOV.OpenID": {
      "authors": [
        "M. Varley, P. Grassi"
      ],
      "date": "October 5 2018",
      "href": "https://openid.net/specs/openid-igov-openid-connect-1_0.html",
      "publisher": "OpenID foundation",
      "title": "International Government Assurance Profile (iGov) for OpenID Connect 1.0 - draft 3"
    },
    "NLGOV.OpenID": {
      "authors": [
        "Remco Schaar, Frank van Es, Joris Joosten, Jan Geert Koops"
      ],
      "href": "https://gitdocumentatie.logius.nl/publicatie/api/oidc/",
      "publisher": "Logius",
      "title": "OpenID NLGov"
    },
    "Introspection": {
      "authors": [
        "J. Richer"
      ],
      "date": "October 2015",
      "href": "https://tools.ietf.org/html/rfc7662",
      "publisher": "IETF",
      "title": "OAuth 2.0 Token Introspection"
    },
    "JWA": {
      "authors": [
        "M. Jones"
      ],
      "date": "may 2015",
      "href": "https://tools.ietf.org/html/rfc7518",
      "publisher": "IETF",
      "title": "JSON Web Algorithms (JWA)"
    },
    "JWE": {
      "authors": [
        "M. Jones, J. Hildebrand"
      ],
      "date": "may 2015",
      "href": "https://tools.ietf.org/html/rfc7516",
      "publisher": "IETF",
      "title": "JSON Web Encryption (JWE)"
    },
    "JWK": {
      "authors": [
        "M. Jones"
      ],
      "date": "may 2015",
      "href": "https://tools.ietf.org/html/rfc7517",
      "publisher": "IETF",
      "title": "JSON Web Key (JWK))"
    },
    "JWS": {
      "authors": [
        "M. Jones, J. Bradley, N. Sakimura"
      ],
      "date": "may 2015",
      "href": "https://tools.ietf.org/html/rfc7515",
      "publisher": "IETF",
      "title": "JSON Web Signature (JWS)"
    },
    "JWT": {
      "authors": [
        "M. Jones, J. Bradley, N. Sakimura"
      ],
      "date": "may 2015",
      "href": "https://tools.ietf.org/html/rfc7519",
      "publisher": "IETF",
      "title": "JSON Web Token (JWT)"
    },
    "NCSC 2019": {
      "date": "April 2019",
      "href": "https://www.ncsc.nl/documenten/publicaties/2019/mei/01/ict-beveiligingsrichtlijnen-voor-transport-layer-security-tls",
      "publisher": "NCSC",
      "title": "ICT-beveiligingsrichtlijnen voor Transport Layer Security (TLS) v2.0"
    },
    "NCSC 2021": {
      "date": "Jan 2021",
      "href": "https://www.ncsc.nl/documenten/publicaties/2021/januari/19/ict-beveiligingsrichtlijnen-voor-transport-layer-security-2.1",
      "publisher": "NCSC",
      "title": "ICT-beveiligingsrichtlijnen voor Transport Layer Security (TLS) v2.1"
    },
    "NCSC 2025": {
      "date": "June 2025",
      "href": "https://www.ncsc.nl/wat-kun-je-zelf-doen/documenten/publicaties/2025/juni/01/ict-beveiligingsrichtlijnen-voor-transport-layer-security-2025-05",
      "publisher": "NCSC",
      "title": "ICT-beveiligingsrichtlijnen voor Transport Layer Security (TLS) v2.1"
    },
    "NEN3610": {
      "authors": [
        ""
      ],
      "date": "Maart 2011",
      "href": "https://www.nen.nl/nen-3610-2011-a1-2016-nl-217738",
      "publisher": "Nederlands Normalisatie-instituut",
      "title": "Basismodel Geo-informatie - Termen, definities, relaties en algemene regels voor de uitwisseling van informatie over aan de aarde gerelateerde ruimtelijke objecten"
    },
    "no-Reliable-messaging": {
      "authors": [
        "Marc de Graauw"
      ],
      "date": "June 18, 2010",
      "href": "https://www.infoq.com/articles/no-reliable-messaging/",
      "publisher": "infoQ",
      "title": "Nobody Needs Reliable Messaging"
    },
    "OAuth2": {
      "authors": [
        "D. Hardt"
      ],
      "date": "October 2012",
      "href": "https://tools.ietf.org/html/rfc6749",
      "publisher": "The Internet Engineering Task Force",
      "title": "The OAuth 2.0 Authorization Framework"
    },
    "OpenID.Core": {
      "authors": [
        "N. Sakimura, J. Bradley, M. Jones, B. de Medeiros, C. Mortimore"
      ],
      "date": "November 8 2014",
      "href": "https://openid.net/specs/openid-connect-core-1_0.html",
      "publisher": "OpenID foundation",
      "title": "OpenID Connect Core 1.0"
    },
    "OpenID.Discovery": {
      "authors": [
        "N. Sakimura, J. Bradley, M. Jones, E. Jay"
      ],
      "date": "November 8 2014",
      "href": "https://openid.net/specs/openid-connect-discovery-1_0.html",
      "publisher": "OpenID foundation",
      "title": "OpenID Connect Discovery 1.0"
    },
    "Pas-toe-of-leg-uit": {
      "href": "https://www.forumstandaardisatie.nl/open-standaarden/verplicht",
      "publisher": "Forum Standaardisatie",
      "title": "Lijst Verplichte standaarden"
    },
    "PKIO-PvE": {
      "href": "https://por.pkioverheid.nl/",
      "publisher": "Logius",
      "title": "Certificate Policy/Programme of Requirements PKIoverheid"
    },
    "PKI-CA": {
      "href": "https://www.logius.nl/domeinen/toegang/aansluiten-als-trust-service-provider",
      "publisher": "Logius",
      "title": "Aansluiten als Trust Service Provider"
    },
    "PKIoverheid": {
      "href": "https://www.logius.nl/domeinen/toegang/pkioverheid",
      "publisher": "Logius",
      "title": "PKIoverheid"
    },
    "PKIO-Cert": {
      "href": "https://cert.pkioverheid.nl/",
      "publisher": "Logius",
      "title": "Overzicht PKIoverheid certificaten"
    },
    "SemVer": {
      "authors": [
        "T. Preston-Werner"
      ],
      "date": "June 2013",
      "href": "https://semver.org",
      "title": "Semantic Versioning 2.0.0"
    },
    "ADR-TS": {
      "authors": [
        ""
      ],
      "date": "March 07, 2024",
      "href": "https://gitdocumentatie.logius.nl/publicatie/api/mod-ts/",
      "publisher": "Kennisplatform API's",
      "title": "API Design Rules Module: Transport Security"
    },
    "UMMR10": {
      "authors": [
        ""
      ],
      "date": "2001",
      "href": "https://unece.org/DAM/cefact/umm/UMM_Revision_10_2001.zip",
      "publisher": "UN/CEFACT",
      "title": "UMM Revision 10"
    },
    "UMMUG": {
      "authors": [
        ""
      ],
      "date": "2003",
      "href": "https://www.unece.org/fileadmin/DAM/cefact/umm/UMM_userguide_220606.pdf",
      "publisher": "UN/CEFACT",
      "title": "UN/CEFACT Modeling Methodology (UMM) User Guide"
    },
    "UUID": {
      "authors": [
        "P. Leach",
        "M. Mealling",
        "R. Salz"
      ],
      "date": "July 2005",
      "href": "https://tools.ietf.org/html/rfc4122",
      "publisher": "The Internet Engineering Task Force",
      "title": "A Universally Unique IDentifier (UUID) URN Namespace"
    },
    "DK-Voorwaarden": {
      "date": "1 januari 2021",
      "href": "https://www.logius.nl/domeinen/gegevensuitwisseling/digikoppeling/documentatie/voorwaarden-digikoppeling",
      "publisher": "Logius",
      "title": "Voorwaarden Digikoppeling"
    },
    "X520": {
      "href": "https://www.iso.org/standard/43796.html",
      "publisher": "ISO",
      "title": "ITU-T Recommendation X.520 (2001) ISO/IEC 9594-6"
    },
    "ADR-Validator": {
      "href": "https://gitlab.com/commonground/don/adr-validator/-/tree/v0.5.0/pkg/rulesets",
      "title": "Technical ADR Validation rule testset 0.5.0",
      "authors": [
        "H. Stijns"
      ],
      "publisher": "Geonovum",
      "date": "November 2023"
    },
    "JRC117836": {
      "href": "https://op.europa.eu/en/publication-detail/-/publication/6521f427-01df-11ea-8c1f-01aa75ed71a1",
      "title": "The Relationship Between Open Source Software and Standard Setting",
      "authors": [
        "Knut Blind",
        "Mirko Böhm"
      ],
      "editors": [
        "Nikolaus Thumm"
      ],
      "publisher": "Joint Research Center",
      "id": "JRC117836",
      "date": "2019"
    },
    "Krechmer2002": {
      "href": "https://www.isology.com/pdf/cathedrals.pdf",
      "title": "Cathedrals, Libraries and Bazaars",
      "authors": [
        "Ken Krechmer"
      ],
      "publisher": "Association of Computing Machinery (ACM)",
      "date": "March 2002"
    },
    "FSC-Core": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/fsc/core/1.0.0/",
      "title": "FSC - Core",
      "authors": [
        "Eelco Hotting",
        "Ronald Koster",
        "Henk van Maanen",
        "Niels Dequeker",
        "Edward van Gelderen",
        "Pim Gaemers"
      ],
      "publisher": "Logius"
    },
    "FSC-Logging": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/fsc/logging/1.0.0/",
      "title": "FSC - Logging",
      "authors": [
        "Eelco Hotting",
        "Ronald Koster",
        "Henk van Maanen",
        "Niels Dequeker",
        "Edward van Gelderen",
        "Pim Gaemers"
      ],
      "publisher": "Logius"
    },
    "HEART.OAuth2": {
      "authors": [
        "J. Richer"
      ],
      "date": "April 25, 2017",
      "href": "https://openid.net/specs/openid-heart-oauth2-1_0.html",
      "publisher": "OpenID foundation",
      "title": "Health Relationship Trust Profile for OAuth 2.0"
    },
    "JWS.JWE.Algs": {
      "authors": [
        "Jim Schaad, Jeff Hodges, Joe Hildebrand, Sean Turner"
      ],
      "date": "",
      "href": "https://www.iana.org/assignments/jose/jose.xhtml#web-signature-encryption-algorithms",
      "publisher": "IANA",
      "title": "IANA JSON Web Signatures and Encryption Algorithms registry"
    },
    "I-D.ietf-oauth-pop-architecture": {
      "authors": [
        "P. Hunt, J. Richer, W. Mills, P. Mishra, H. Tschofenig"
      ],
      "date": "July 8, 2016",
      "href": "https://tools.ietf.org/html/draft-ietf-oauth-pop-architecture-08",
      "publisher": "IETF",
      "title": "OAuth 2.0 Proof-of-Possession (PoP) Security Architecture"
    },
    "iGOV.OAuth2": {
      "authors": [
        "J. Richer, M. Varley, P. Grassi"
      ],
      "date": "October 5 2018",
      "href": "https://openid.net/specs/openid-igov-oauth2-1_0-03.html",
      "publisher": "OpenID foundation",
      "title": "International Government Assurance Profile (iGov) for OAuth 2.0"
    },
    "NLGOV.OAuth2": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/api/oauth/",
      "publisher": "Logius",
      "title": "NL GOV Assurance profile for OAuth 2.0"
    },
    "ietf-oauth-v2-1-10-refresh-token-grant": {
      "authors": [
        "Dick Hardt, Aaron Parecki, Torsten Lodderstedt"
      ],
      "date": "January 9, 2024",
      "href": "https://datatracker.ietf.org/doc/html/draft-ietf-oauth-v2-1-10#name-refresh-token-grant",
      "publisher": "IETF",
      "title": "The OAuth 2.1 Authorization Framework: Refresh Token Grant"
    },
    "OpenID.FAPI2.0": {
      "authors": [
        "D. Fett, D. Tonge, J. Heenan"
      ],
      "date": "February 22 2025",
      "href": "https://openid.net/specs/fapi-security-profile-2_0-final.html",
      "publisher": "OpenID foundation",
      "title": "FAPI 2.0 Security Profile"
    },
    "logboek-extensie-guideline": {
      "href": "https://logius-standaarden.github.io/logboek-extensie-template/",
      "publisher": "Logius",
      "title": "LDV Extensie Guideline"
    },
    "logboek dataverwerkingen": {
      "href": "https://logius-standaarden.github.io/logboek-dataverwerkingen/",
      "publisher": "Logius",
      "title": "Logboek Dataverwerkingen"
    },
    "JAdES": {
      "href": "https://www.etsi.org/deliver/etsi_ts/119100_119199/11918201/01.01.01_60/ts_11918201v010101p.pdf",
      "title": "JAdES digital signatures",
      "id": "jades"
    }
  },
  "pubDomain": "api",
  "shortName": "mod-signing",
  "specType": "ST",
  "specStatus": "WV",
  "publishDate": "2024-09-06",
  "publishVersion": "1.0.0",
  "editors": [
    {
      "name": "Logius Standaarden",
      "company": "Logius",
      "companyURL": "https://www.logius.nl"
    }
  ],
  "authors": [
    {
      "name": "Peter Haasnoot",
      "company": "Logius",
      "companyURL": "https://www.logius.nl"
    }
  ],
  "github": "https://github.com/Logius-standaarden/API-mod-signing/",
  "postProcess": [
    null
  ],
  "preProcess": [
    null,
    null
  ]
}</script>
<link rel="stylesheet" href="https://gitdocumentatie.logius.nl/publicatie/respec/style/base.css">
<link rel="stylesheet" media="(prefers-color-scheme: dark)" href="https://gitdocumentatie.logius.nl/publicatie/respec/style/dark.css"></head>

<body class="h-entry toc-inline"><div class="head">
    <a class="logo" href="https://www.logius.nl/onze-dienstverlening/standaarden"><img alt="Logius" height="77" id="Logius" src="https://gitdocumentatie.logius.nl/publicatie/respec/style/logos/figure-logius.svg" width="44">
  </a> <h1 id="title" class="title">API Design Rules Module: Signing</h1>
    
    <h2>
      Logius Standard<br>
      Draft
      <time class="dt-published" datetime="2024-09-06">November 19, 2025</time>
    </h2>
    <dl>
      <dt>This version:</dt><dd class="status">
              <a class="u-url status" href="https://logius-standaarden.github.io/API-mod-signing/">https://logius-standaarden.github.io/API-mod-signing/</a>
            </dd>
      <dt>Latest published version:</dt><dd>
              <a href="https://logius-standaarden.github.io/API-mod-signing/">https://logius-standaarden.github.io/API-mod-signing/</a>
            </dd>
      <dt>Latest editor's draft:</dt><dd><a href="https://logius-standaarden.github.io/API-mod-signing/">https://logius-standaarden.github.io/API-mod-signing/</a></dd>
      
      
      
      
      
      <dt>Editor:</dt>
      <dd class="editor p-author h-card vcard">
    <span class="p-name fn">Logius Standaarden</span> (<a class="p-org org h-org" href="https://www.logius.nl">Logius</a>)
  </dd>
      
      <dt>Author:</dt><dd class="editor p-author h-card vcard">
    <span class="p-name fn">Peter Haasnoot</span> (<a class="p-org org h-org" href="https://www.logius.nl">Logius</a>)
  </dd>
      <dt>Participate:</dt><dd>
    <a href="https://github.com/Logius-standaarden/API-mod-signing/">GitHub Logius-standaarden/API-mod-signing</a>
  </dd><dd>
    <a href="https://github.com/Logius-standaarden/API-mod-signing/issues/">File an issue</a>
  </dd><dd>
    <a href="https://github.com/Logius-standaarden/API-mod-signing/commits/">Commit history</a>
  </dd><dd>
    <a href="https://github.com/Logius-standaarden/API-mod-signing/pulls/">Pull requests</a>
  </dd>
    </dl>
    
    
    <p>
          This document is also available in these non-normative format:
          <a rel="alternate" href="api-mod-signing-1.0.0.pdf">PDF</a>
        </p>
    <p class="copyright">
            This document is licensed under 
            <a rel="license" href="https://creativecommons.org/licenses/by/4.0/legalcode" class="subfoot"><img class="license" src="https://gitdocumentatie.logius.nl/publicatie/respec/media/logos/cc-by.svg" alt="Logo Creative Commons Attribution 4.0 International Public License"><br> Creative Commons Attribution 4.0 International Public License</a>
          </p>
    <hr title="Separator for header">
  </div><section id="sotd" class="introductory"><h2>Status of This Document</h2><p>This is a draft that could be altered, removed or replaced by other documents. It is not a recommendation approved by TO.</p></section><nav id="toc"><h2 class="introductory" id="table-of-contents">Table of Contents</h2><ol class="toc"><li class="tocline"><a class="tocxref" href="#sotd">Status of This Document</a></li><li class="tocline"><a class="tocxref" href="#conformance">Conformance</a></li><li class="tocline"><a class="tocxref" href="#abstract">Abstract</a></li><li class="tocline"><a class="tocxref" href="#introduction"><bdi class="secno">1. </bdi>Introduction</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#use-cases"><bdi class="secno">1.1 </bdi>Use Cases</a></li><li class="tocline"><a class="tocxref" href="#jws-detached-signatures"><bdi class="secno">1.2 </bdi>JWS detached signatures</a></li></ol></li><li class="tocline"><a class="tocxref" href="#normative-design-rules"><bdi class="secno">2. </bdi>Normative Design Rules</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#summary"><bdi class="secno">2.1 </bdi>Summary</a></li><li class="tocline"><a class="tocxref" href="#cryptographic-algorithms"><bdi class="secno">2.2 </bdi>Cryptographic Algorithms</a></li><li class="tocline"><a class="tocxref" href="#payload-signing"><bdi class="secno">2.3 </bdi>Payload signing</a></li><li class="tocline"><a class="tocxref" href="#message-signing"><bdi class="secno">2.4 </bdi>Message signing</a></li></ol></li><li class="tocline"><a class="tocxref" href="#signature-representations"><bdi class="secno">A. </bdi>Signature Representations</a></li><li class="tocline"><a class="tocxref" href="#tooling"><bdi class="secno">B. </bdi>Tooling</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#digital-signature-service"><bdi class="secno">B.1 </bdi>Digital Signature Service</a></li><li class="tocline"><a class="tocxref" href="#jwt-jws-jwe-jwk-and-jwa-implementations"><bdi class="secno">B.2 </bdi>JWT, JWS, JWE, JWK, and JWA Implementations</a></li></ol></li><li class="tocline"><a class="tocxref" href="#references"><bdi class="secno">C. </bdi>References</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#normative-references"><bdi class="secno">C.1 </bdi>Normative references</a></li></ol></li></ol></nav><section id="conformance" class="introductory"><div class="header-wrapper"><h2 id="conformance-0">Conformance</h2><a class="self-link" href="#conformance" aria-label="Permalink for this Section"></a></div><p>As well as sections marked as non-normative, all authoring guidelines, diagrams, examples, and notes in this specification are non-normative. Everything else in this specification is normative.</p><p>
        The key words <em class="rfc2119">MUST</em> and <em class="rfc2119">SHOULD</em> in this document
        are to be interpreted as described in
        <a href="https://www.rfc-editor.org/info/bcp14">BCP 14</a>
        [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">RFC2119</a></cite>] [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8174" title="Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words">RFC8174</a></cite>]
        when, and only when, they appear in all
        capitals, as shown here.
      </p>
  </section>
  <section id="abstract" class="introductory"><h2>Abstract</h2><p>This document is part of the <em>Nederlandse API Strategie</em>.</p>
<p>The Nederlandse API Strategie consists of <a href="https://www.geonovum.nl/themas/kennisplatform-apis#APIStrategie">a set of distinct documents</a>.</p>
<table>
<thead>
<tr>
<th>Status</th>
<th>Description &amp; Link</th>
</tr>
</thead>
<tbody><tr>
<td>Informative</td>
<td><a href="https://geonovum.github.io/KP-APIs/API-strategie-algemeen/Inleiding/">Inleiding NL API Strategie</a></td>
</tr>
<tr>
<td>Informative</td>
<td><a href="https://geonovum.github.io/KP-APIs/API-strategie-algemeen/Architectuur/">Architectuur NL API Strategie</a></td>
</tr>
<tr>
<td>Informative</td>
<td><a href="https://geonovum.github.io/KP-APIs/API-strategie-algemeen/Gebruikerswensen/">Gebruikerswensen NL API Strategie</a></td>
</tr>
<tr>
<td>Normative</td>
<td><a href="https://gitdocumentatie.logius.nl/publicatie/api/adr/2.0/">API Design Rules (ADR v2.0)</a></td>
</tr>
<tr>
<td>Normative</td>
<td><a href="https://spec.openapis.org/oas/v3.0.1.html">Open API Specification (OAS 3.0)</a></td>
</tr>
<tr>
<td>Normative</td>
<td><a href="https://gitdocumentatie.logius.nl/publicatie/api/oauth/">NL GOV OAuth profiel</a></td>
</tr>
<tr>
<td>Normative</td>
<td><a href="https://gitdocumentatie.logius.nl/publicatie/dk/restapi/">Digikoppeling REST API koppelvlak specificatie</a></td>
</tr>
<tr>
<td>Normative module</td>
<td><a href="https://gitdocumentatie.logius.nl/publicatie/api/mod-geo/1.0.2/">GEO module v1.0</a></td>
</tr>
</tbody></table>
<p>Before reading this document it is advised to gain knowledge of the informative documents, in particular the <a href="https://geonovum.github.io/KP-APIs/API-strategie-algemeen/Architectuur/">Architecture</a>.</p>

<p>This ADR Module contains the requirements for ADR-HTTP Message and payload signing with <cite><a data-matched-text="[[[JAdES]]]" href="https://www.etsi.org/deliver/etsi_ts/119100_119199/11918201/01.01.01_60/ts_11918201v010101p.pdf">JAdES digital signatures</a></cite>.</p>
<p>This module is based on the <em>ISA² IPS REST API Profile v1.0 section 5.2.2 Message And Payload Level Security</em>.</p>
</section>
  
  
  <section id="introduction"><div class="header-wrapper"><h2 id="x1-introduction"><bdi class="secno">1. </bdi>Introduction</h2><a class="self-link" href="#introduction" aria-label="Permalink for Section 1."></a></div>
<p>This module specifies the use of JAdES signatures for HTTP message and payload siging. The module is directly based on the <em>ISA² IPS REST API Profile v1.0</em> (which was a result of the <a href="https://interoperable-europe.ec.europa.eu/collection/api4dt/document/isa2-ips-rest-api-profile">REST API Pilot project for eDelivery</a>)</p>
<section id="use-cases"><div class="header-wrapper"><h3 id="x1-1-use-cases"><bdi class="secno">1.1 </bdi>Use Cases</h3><a class="self-link" href="#use-cases" aria-label="Permalink for Section 1.1"></a></div>
<p>This module is applicable when there is a need for assurance of end to end message integrity and authenticity between client application and server application.
In the context of HTTP messages signing header elements (for example HTTP operation (GET/POST/UPDATE/DELETE) and resource path / parameters, or timestamps) together with payload provides an extra level of protection against manipulation of the message.</p>
<p>In a complex IT landscape the path between client and server can go over several intermediary components/systems in which case end to end integrity and authenticity can be especially relevant. (In this case TLS is terminated in each step on the path and does not protect the http-message in transport fully end to end).</p>
</section><section id="jws-detached-signatures"><div class="header-wrapper"><h3 id="x1-2-jws-detached-signatures"><bdi class="secno">1.2 </bdi>JWS detached signatures</h3><a class="self-link" href="#jws-detached-signatures" aria-label="Permalink for Section 1.2"></a></div>
<p>This module enforces the use of JWS detached signatures following the HTTP Headers Mechanism of the ETSI ESI JAdES specification [<cite><a class="bibref" data-link-type="biblio" href="#bib-jades" title="JAdES digital signatures">JAdES</a></cite>].</p>
<p>This structure is enforced for the following reasons:</p>
<ul>
<li>JWS, being a simple JSON Structure, can be supported by clients in a light context, while specifications like the ETSI ESI ASIC containers are more difficult to do.</li>
<li>JWS in detached form does not change the payload structure, meaning that a client not supporting the validation of signature can continue to operate as if there was no signature applied.</li>
<li>JWS Detached can be transported using an HTTP header, making its presence unintrusive and easily transportable.</li>
</ul>
</section></section>
  <section id="normative-design-rules"><div class="header-wrapper"><h2 id="x2-normative-design-rules"><bdi class="secno">2. </bdi>Normative Design Rules</h2><a class="self-link" href="#normative-design-rules" aria-label="Permalink for Section 2."></a></div>
<section id="summary"><div class="header-wrapper"><h3 id="x2-1-summary"><bdi class="secno">2.1 </bdi>Summary</h3><a class="self-link" href="#summary" aria-label="Permalink for Section 2.1"></a></div>
<div id="design-rule-summary">Design rules are technical rules, which should be tested automatically.<h3 id="list-of-technical-rules">List of technical rules</h3><ul><li><a href="#/signing/algorithm">/signing/algorithm</a>: Support the RSASSA-PSS Algorithm</li><li><a href="#/signing/payload">/signing/payload</a>: Apply JAdES detached signatures for payload signing</li><li><a href="#/signing/message">/signing/message</a>: Apply JAdES HttpHeaders Mechanism for message-level security</li></ul></div>

</section><section id="cryptographic-algorithms"><div class="header-wrapper"><h3 id="x2-2-cryptographic-algorithms"><bdi class="secno">2.2 </bdi>Cryptographic Algorithms</h3><a class="self-link" href="#cryptographic-algorithms" aria-label="Permalink for Section 2.2"></a></div>
<div class="rule" id="/signing/algorithm" data-type="technical"><div title="This is a technical design rule and hence should be tested automatically." class="flag">technical</div>
   <p class="rulelab"><a href="#/signing/algorithm">/signing/algorithm</a>: Support the RSASSA-PSS Algorithm</p>
   <dl>
   <dt>Statement</dt>
   <dd>
   The RSASSA-PSS Algorithm <em class="rfc2119">MUST</em> be supported, with a key length of at least 256 bits. The value <code>PS256</code> for the <code>alg</code> parameter <em class="rfc2119">MUST</em> be used as defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7518" title="JSON Web Algorithms (JWA)">RFC7518</a></cite>].
   </dd>
</dl>
</div>

</section><section id="payload-signing"><div class="header-wrapper"><h3 id="x2-3-payload-signing"><bdi class="secno">2.3 </bdi>Payload signing</h3><a class="self-link" href="#payload-signing" aria-label="Permalink for Section 2.3"></a></div>
<div class="rule" id="/signing/payload" data-type="technical"><div title="This is a technical design rule and hence should be tested automatically." class="flag">technical</div>
   <p class="rulelab"><a href="#/signing/payload">/signing/payload</a>: Apply JAdES detached signatures for payload signing</p>
   <dl>
   <dt>Statement</dt>
   <dd>
Payload signing ensures the integrity and authenticity of the payload part of the message.  When payload signing is considered, the Detached JSON Web Signatures following the JAdES specification [<cite><a class="bibref" data-link-type="biblio" href="#bib-jades" title="JAdES digital signatures">JAdES</a></cite>] <em class="rfc2119">MUST</em> be applied with the following restrictions:

<ul>
<li>The JWS content (Data to be Signed) <em class="rfc2119">MUST</em> be detached from the signatures as defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7515" title="JSON Web Signature (JWS)">RFC7515</a></cite>] Appendix F.</li>
<li>The signed SigD parameter object <em class="rfc2119">MUST</em> be present in the JWS headers, denoting the use of the JAdES detached header profile.</li>
<li>The value of the <code>mId</code> parameter <em class="rfc2119">MUST</em> be set to <code>http://uri.etsi.org/19182/HttpHeaders</code>.</li>
<li>The <code>pars</code> array of the SigD <em class="rfc2119">MUST</em> contain only the element <code>digest</code>, denoting that for the calculation of the signature only the digest of the HTTP payload must be taken into account, according to [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc3230" title="Instance Digests in HTTP">RFC3230</a></cite>].</li>
<li>The <code>alg</code> parameter <em class="rfc2119">MUST</em> be set to the correct value depending on the algorithm used (see <a href="#cryptographic-algorithms" data-matched-text="[[[#cryptographic-algorithms]]]" class="sec-ref"><bdi class="secno">2.2 </bdi>Cryptographic Algorithms</a>).</li>
</ul>
<p>The JWS structure shall be carried in HTTP header field named <code>Payload-Signature</code>. The header field can be used in both requests and responses. The header field <em class="rfc2119">MUST</em> not appear more than once in a message; if a message contains multiple <code>Payload-Signature</code> header fields, the receiver <em class="rfc2119">MUST</em> consider the signature invalid.
   </p></dd><p></p>
</dl>
</div>

</section><section id="message-signing"><div class="header-wrapper"><h3 id="x2-4-message-signing"><bdi class="secno">2.4 </bdi>Message signing</h3><a class="self-link" href="#message-signing" aria-label="Permalink for Section 2.4"></a></div>
<p>The Introduction section of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9421" title="HTTP Message Signatures">RFC9421</a></cite>] details why message integrity and authenticity are critical to the secure operation of many HTTP/REST applications.</p>
<div class="rule" id="/signing/message" data-type="technical"><div title="This is a technical design rule and hence should be tested automatically." class="flag">technical</div>
   <p class="rulelab"><a href="#/signing/message">/signing/message</a>: Apply JAdES HttpHeaders Mechanism for message-level security</p>
   <dl>
   <dt>Statement</dt>
   <dd>
When Message-Level Security is considered, the HttpHeaders Mechanism of the JAdES Specification [<cite><a class="bibref" data-link-type="biblio" href="#bib-jades" title="JAdES digital signatures">JAdES</a></cite>] <em class="rfc2119">MUST</em> be used, with the following restrictions applied.

<ul>
<li>The JWS content (Data to be Signed) <em class="rfc2119">MUST</em> be detached from the signatures as defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7515" title="JSON Web Signature (JWS)">RFC7515</a></cite>] Appendix F.</li>
<li>The signed SigD parameter object <em class="rfc2119">MUST</em> be present in the JWS headers, denoting the use of the JAdES detached header profile.</li>
<li>The value of the mId parameter <em class="rfc2119">MUST</em> be set to <code>http://uri.etsi.org/19182/HttpHeaders</code>.</li>
<li>The pars array of the SigD <em class="rfc2119">MUST</em> contain at least the following elements:<ul>
<li>the element <code>(request-target)</code>, for containing the HTTP Request URI</li>
<li>the element <code>host</code>, for containing the host the message was submitted to, if present</li>
<li>the element <code>origin</code>, for containing the scheme, hostname, and port from which the request was initiated, if present</li>
<li>the element <code>content-encoding</code>, if present</li>
<li>the element <code>content-type</code>, if present</li>
<li>the element <code>content-length</code>, if present</li>
<li>the element <code>digest</code>, for taking into account the Digest header that contains the hash value of the HTTP payload.</li>
</ul>
</li>
<li>The alg parameter <em class="rfc2119">MUST</em> be set to the correct value depending on the algorithm used (see above).</li>
</ul>
<p>Implementations that make use of the HTTP Header fields for data representation <em class="rfc2119">SHOULD</em> also include these header fields in the pars array. The JWS structure <em class="rfc2119">MUST</em> be carried in HTTP header field named <code>Message-Signature</code>. The header field can be used in both requests and responses. The header field <em class="rfc2119">MUST</em> not appear more than once in a message; if a message contains multiple <code>Message-Signature</code> header fields, the receiver <em class="rfc2119">MUST</em> consider the signature invalid.
   </p></dd><p></p>
</dl>
</div></section></section>
  <section class="informative appendix" id="signature-representations"><div class="header-wrapper"><h2 id="a-signature-representations"><bdi class="secno">A. </bdi>Signature Representations</h2><a class="self-link" href="#signature-representations" aria-label="Permalink for Appendix A."></a></div><p><em>This section is non-normative.</em></p>
<pre><code class="yaml hljs" aria-busy="false"><span class="hljs-attr">openapi:</span> <span class="hljs-number">3.1</span><span class="hljs-number">.0</span>
<span class="hljs-attr">info:</span>
    <span class="hljs-attr">title:</span> <span class="hljs-string">JAdES</span> <span class="hljs-string">Signatures</span>
    <span class="hljs-attr">summary:</span> <span class="hljs-string">An</span> <span class="hljs-string">example</span> <span class="hljs-string">showcasing</span> <span class="hljs-string">JAdES</span> <span class="hljs-string">signatures</span>
    <span class="hljs-attr">description:</span> <span class="hljs-string">An</span> <span class="hljs-string">example</span> <span class="hljs-string">showcasing</span> <span class="hljs-string">JAdES</span> <span class="hljs-string">signatures</span> <span class="hljs-string">as</span> <span class="hljs-string">JWS</span> <span class="hljs-string">detached</span> <span class="hljs-string">signatures</span> <span class="hljs-string">for</span> <span class="hljs-string">securing</span> <span class="hljs-string">a</span> <span class="hljs-string">sample</span> <span class="hljs-string">REST</span> <span class="hljs-string">endpoint</span> <span class="hljs-string">(/certificate)</span>
    <span class="hljs-attr">termsOfService:</span> <span class="hljs-string">https://domain.server.io/terms-of-service</span>
    <span class="hljs-attr">license:</span>
        <span class="hljs-attr">name:</span> <span class="hljs-string">EUPL-1.2</span> <span class="hljs-string">or</span> <span class="hljs-string">later</span>
        <span class="hljs-attr">url:</span> <span class="hljs-string">https://eupl.eu/1.2/en/</span>
    <span class="hljs-attr">version:</span> <span class="hljs-number">1.0</span><span class="hljs-number">.0</span>
<span class="hljs-attr">externalDocs:</span>
   <span class="hljs-attr">description:</span> <span class="hljs-string">The</span> <span class="hljs-string">ISA²</span> <span class="hljs-string">IPS</span> <span class="hljs-string">REST</span> <span class="hljs-string">API</span> <span class="hljs-string">Core</span> <span class="hljs-string">Profile</span>
   <span class="hljs-attr">url:</span> <span class="hljs-string">https://joinup.ec.europa.eu/collection/api4dt/document/isa2-ips-rest-api-profile</span>
<span class="hljs-attr">servers:</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">url:</span> <span class="hljs-string">https://domain.server.io/v2</span>
<span class="hljs-attr">tags:</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">DetachedPayloadSignature</span>
  <span class="hljs-attr">description:</span> <span class="hljs-string">Operations</span> <span class="hljs-string">using</span> <span class="hljs-string">payload</span> <span class="hljs-string">security</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">DetachedMessageSignature</span>
  <span class="hljs-attr">description:</span> <span class="hljs-string">Operations</span> <span class="hljs-string">using</span> <span class="hljs-string">message-level</span> <span class="hljs-string">security</span>
<span class="hljs-attr">paths:</span>
    <span class="hljs-string">/openapi:</span>
        <span class="hljs-attr">get:</span>
            <span class="hljs-attr">summary:</span> <span class="hljs-string">Returns</span> <span class="hljs-string">the</span> <span class="hljs-string">OpenAPI</span> <span class="hljs-string">Document</span> <span class="hljs-string">for</span> <span class="hljs-string">the</span> <span class="hljs-string">API</span>
        <span class="hljs-string">...</span>
        <span class="hljs-attr">responses:</span>
        <span class="hljs-attr">200:</span>
            <span class="hljs-attr">description:</span> <span class="hljs-string">...</span>
            <span class="hljs-attr">content:</span> {
               <span class="hljs-string">$ref:</span> <span class="hljs-string">'https://spec.openapis.org/oas/3.1/schema/2021-05-20'</span>
               <span class="hljs-string">...</span>
            }
    <span class="hljs-string">/certificate:</span>
    <span class="hljs-attr">get:</span>
      <span class="hljs-attr">tags:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">DetachedMessageSignature</span>
      <span class="hljs-attr">summary:</span> <span class="hljs-string">Get</span> <span class="hljs-string">a</span> <span class="hljs-string">Certificate</span>
      <span class="hljs-attr">securitySchemes:</span>
        <span class="hljs-attr">OAuth2:</span>
           <span class="hljs-attr">type:</span> <span class="hljs-string">oauth2</span>
        <span class="hljs-attr">flows:</span>
           <span class="hljs-attr">authorizationCode:</span>
              <span class="hljs-attr">authorizationUrl:</span> <span class="hljs-string">https://example.com/api/oauth/dialog</span>
              <span class="hljs-attr">scopes:</span>
                 <span class="hljs-attr">send:message:</span> <span class="hljs-string">send</span> <span class="hljs-string">a</span> <span class="hljs-string">message</span>
       <span class="hljs-string">...</span>
      <span class="hljs-attr">responses:</span>
      <span class="hljs-attr">200:</span>
         <span class="hljs-attr">headers:</span>
            <span class="hljs-attr">nlgov-adr-message-sig:</span>
               <span class="hljs-string">$ref:</span> <span class="hljs-string">'#/components/headers/nlgov-adr-message-sig'</span>
          <span class="hljs-attr">description:</span> <span class="hljs-string">List</span> <span class="hljs-string">of</span> <span class="hljs-string">Certificates</span>
          <span class="hljs-attr">content:</span> { <span class="hljs-string">...</span> }
<span class="hljs-attr">components:</span>
   <span class="hljs-attr">headers:</span>
      <span class="hljs-attr">nlgov-adr-payload-sig:</span>
         <span class="hljs-attr">schema:</span>
             <span class="hljs-string">$ref:</span> <span class="hljs-string">'#/components/schemas/JwsCompactDetached'</span>
      <span class="hljs-attr">nlgov-adr-message-sig:</span>
         <span class="hljs-attr">schema:</span>
             <span class="hljs-string">$ref:</span> <span class="hljs-string">'#/components/schemas/JwsCompactDetached'</span>
   <span class="hljs-attr">schemas:</span>
      <span class="hljs-attr">JwsCompactDetached:</span>
         <span class="hljs-attr">title:</span> <span class="hljs-string">The</span> <span class="hljs-string">format</span> <span class="hljs-string">for</span> <span class="hljs-string">the</span> <span class="hljs-string">message-level</span> <span class="hljs-string">and</span> <span class="hljs-string">payload</span> <span class="hljs-string">signature</span>
         <span class="hljs-attr">description:</span> <span class="hljs-string">Defines</span> <span class="hljs-string">the</span> <span class="hljs-string">string</span> <span class="hljs-string">pattern</span> <span class="hljs-string">as</span> <span class="hljs-string">a</span> <span class="hljs-string">regular</span> <span class="hljs-string">expression</span> <span class="hljs-string">that</span>
         <span class="hljs-string">MUST</span> <span class="hljs-string">be</span> <span class="hljs-string">followed</span> <span class="hljs-string">to</span> <span class="hljs-string">represent</span> <span class="hljs-string">detached</span> <span class="hljs-string">JWS</span> <span class="hljs-string">compact</span> <span class="hljs-string">tokens</span>
        <span class="hljs-string">"$id"</span><span class="hljs-string">:</span> <span class="hljs-string">https://raw.githubusercontent.com/isa2-api4ips/rest-api-profile/main/api-core-profile/components/schemas/jws-compact-detached.json</span>
        <span class="hljs-string">"$schema"</span><span class="hljs-string">:</span> <span class="hljs-string">https://json-schema.org/draft/2020-12/schema</span>
         <span class="hljs-attr">type:</span> <span class="hljs-string">string</span>
         <span class="hljs-attr">format:</span> <span class="hljs-string">jws-compact-detached</span>
         <span class="hljs-attr">pattern:</span> <span class="hljs-string">^[A-Za-z0-9_-]+(?:(\\.\\.)[A-Za-z0-9_-]+){1}</span>
</code></pre>
</section>
  <section class="informative appendix" id="tooling"><div class="header-wrapper"><h2 id="b-tooling"><bdi class="secno">B. </bdi>Tooling</h2><a class="self-link" href="#tooling" aria-label="Permalink for Appendix B."></a></div><p><em>This section is non-normative.</em></p>
<section id="digital-signature-service"><div class="header-wrapper"><h3 id="b-1-digital-signature-service"><bdi class="secno">B.1 </bdi>Digital Signature Service</h3><a class="self-link" href="#digital-signature-service" aria-label="Permalink for Appendix B.1"></a></div>
<p>The DSS (Digital Signature Service) project is an open-source software library, aimed at providing implementation of the standards for Advanced Electronic Signature creation, augmentation and validation in line with European legislation and the eIDAS Regulation in particular.</p>
<p><a href="https://ec.europa.eu/digital-building-blocks/DSS/webapp-demo/doc/dss-documentation.html">https://ec.europa.eu/digital-building-blocks/DSS/webapp-demo/doc/dss-documentation.html</a></p>
</section><section id="jwt-jws-jwe-jwk-and-jwa-implementations"><div class="header-wrapper"><h3 id="b-2-jwt-jws-jwe-jwk-and-jwa-implementations"><bdi class="secno">B.2 </bdi>JWT, JWS, JWE, JWK, and JWA Implementations</h3><a class="self-link" href="#jwt-jws-jwe-jwk-and-jwa-implementations" aria-label="Permalink for Appendix B.2"></a></div>
<p>Libraries implementing JWT and the JOSE specs JWS, JWE, JWK, and JWA are listed here.</p>
<p><a href="https://openid.net/developers/jwt-jws-jwe-jwk-and-jwa-implementations/">https://openid.net/developers/jwt-jws-jwe-jwk-and-jwa-implementations/</a></p>
</section></section><section id="references" class="appendix"><div class="header-wrapper"><h2 id="c-references"><bdi class="secno">C. </bdi>References</h2><a class="self-link" href="#references" aria-label="Permalink for Appendix C."></a></div><section id="normative-references">
    <div class="header-wrapper"><h3 id="c-1-normative-references"><bdi class="secno">C.1 </bdi>Normative references</h3><a class="self-link" href="#normative-references" aria-label="Permalink for Appendix C.1"></a></div>
    <dl class="bibliography"><dt id="bib-jades">[JAdES]</dt><dd>
      <a href="https://www.etsi.org/deliver/etsi_ts/119100_119199/11918201/01.01.01_60/ts_11918201v010101p.pdf"><cite>JAdES digital signatures</cite></a>. URL: <a href="https://www.etsi.org/deliver/etsi_ts/119100_119199/11918201/01.01.01_60/ts_11918201v010101p.pdf">https://www.etsi.org/deliver/etsi_ts/119100_119199/11918201/01.01.01_60/ts_11918201v010101p.pdf</a>
    </dd><dt id="bib-rfc2119">[RFC2119]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. S. Bradner.  IETF. March 1997. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>
    </dd><dt id="bib-rfc3230">[RFC3230]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc3230"><cite>Instance Digests in HTTP</cite></a>. J. Mogul; A. Van Hoff.  IETF. January 2002. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc3230">https://www.rfc-editor.org/rfc/rfc3230</a>
    </dd><dt id="bib-rfc7515">[RFC7515]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc7515"><cite>JSON Web Signature (JWS)</cite></a>. M. Jones; J. Bradley; N. Sakimura.  IETF. May 2015. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7515">https://www.rfc-editor.org/rfc/rfc7515</a>
    </dd><dt id="bib-rfc7518">[RFC7518]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc7518"><cite>JSON Web Algorithms (JWA)</cite></a>. M. Jones.  IETF. May 2015. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7518">https://www.rfc-editor.org/rfc/rfc7518</a>
    </dd><dt id="bib-rfc8174">[RFC8174]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8174"><cite>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</cite></a>. B. Leiba.  IETF. May 2017. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>
    </dd><dt id="bib-rfc9421">[RFC9421]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc9421"><cite>HTTP Message Signatures</cite></a>. A. Backman, Ed.; J. Richer, Ed.; M. Sporny.  IETF. February 2024. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc9421">https://www.rfc-editor.org/rfc/rfc9421</a>
    </dd></dl>
  </section></section><p role="navigation" id="back-to-top">
    <a href="#title"><abbr title="Back to Top">↑</abbr></a>
  </p><script id="respec-dfn-panel">(() => {
// @ts-check
if (document.respec) {
  document.respec.ready.then(setupPanel);
} else {
  setupPanel();
}

function setupPanel() {
  const listener = panelListener();
  document.body.addEventListener("keydown", listener);
  document.body.addEventListener("click", listener);
}

function panelListener() {
  /** @type {HTMLElement} */
  let panel = null;
  return event => {
    const { target, type } = event;

    if (!(target instanceof HTMLElement)) return;

    // For keys, we only care about Enter key to activate the panel
    // otherwise it's activated via a click.
    if (type === "keydown" && event.key !== "Enter") return;

    const action = deriveAction(event);

    switch (action) {
      case "show": {
        hidePanel(panel);
        /** @type {HTMLElement} */
        const dfn = target.closest("dfn, .index-term");
        panel = document.getElementById(`dfn-panel-for-${dfn.id}`);
        const coords = deriveCoordinates(event);
        displayPanel(dfn, panel, coords);
        break;
      }
      case "dock": {
        panel.style.left = null;
        panel.style.top = null;
        panel.classList.add("docked");
        break;
      }
      case "hide": {
        hidePanel(panel);
        panel = null;
        break;
      }
    }
  };
}

/**
 * @param {MouseEvent|KeyboardEvent} event
 */
function deriveCoordinates(event) {
  const target = /** @type HTMLElement */ (event.target);

  // We prevent synthetic AT clicks from putting
  // the dialog in a weird place. The AT events sometimes
  // lack coordinates, so they have clientX/Y = 0
  const rect = target.getBoundingClientRect();
  if (
    event instanceof MouseEvent &&
    event.clientX >= rect.left &&
    event.clientY >= rect.top
  ) {
    // The event probably happened inside the bounding rect...
    return { x: event.clientX, y: event.clientY };
  }

  // Offset to the middle of the element
  const x = rect.x + rect.width / 2;
  // Placed at the bottom of the element
  const y = rect.y + rect.height;
  return { x, y };
}

/**
 * @param {Event} event
 */
function deriveAction(event) {
  const target = /** @type {HTMLElement} */ (event.target);
  const hitALink = !!target.closest("a");
  if (target.closest("dfn:not([data-cite]), .index-term")) {
    return hitALink ? "none" : "show";
  }
  if (target.closest(".dfn-panel")) {
    if (hitALink) {
      return target.classList.contains("self-link") ? "hide" : "dock";
    }
    const panel = target.closest(".dfn-panel");
    return panel.classList.contains("docked") ? "hide" : "none";
  }
  if (document.querySelector(".dfn-panel:not([hidden])")) {
    return "hide";
  }
  return "none";
}

/**
 * @param {HTMLElement} dfn
 * @param {HTMLElement} panel
 * @param {{ x: number, y: number }} clickPosition
 */
function displayPanel(dfn, panel, { x, y }) {
  panel.hidden = false;
  // distance (px) between edge of panel and the pointing triangle (caret)
  const MARGIN = 20;

  const dfnRects = dfn.getClientRects();
  // Find the `top` offset when the `dfn` can be spread across multiple lines
  let closestTop = 0;
  let minDiff = Infinity;
  for (const rect of dfnRects) {
    const { top, bottom } = rect;
    const diffFromClickY = Math.abs((top + bottom) / 2 - y);
    if (diffFromClickY < minDiff) {
      minDiff = diffFromClickY;
      closestTop = top;
    }
  }

  const top = window.scrollY + closestTop + dfnRects[0].height;
  const left = x - MARGIN;
  panel.style.left = `${left}px`;
  panel.style.top = `${top}px`;

  // Find if the panel is flowing out of the window
  const panelRect = panel.getBoundingClientRect();
  const SCREEN_WIDTH = Math.min(window.innerWidth, window.screen.width);
  if (panelRect.right > SCREEN_WIDTH) {
    const newLeft = Math.max(MARGIN, x + MARGIN - panelRect.width);
    const newCaretOffset = left - newLeft;
    panel.style.left = `${newLeft}px`;
    /** @type {HTMLElement} */
    const caret = panel.querySelector(".caret");
    caret.style.left = `${newCaretOffset}px`;
  }

  // As it's a dialog, we trap focus.
  // TODO: when <dialog> becomes a implemented, we should really
  // use that.
  trapFocus(panel, dfn);
}

/**
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function trapFocus(panel, dfn) {
  /** @type NodeListOf<HTMLAnchorElement> elements */
  const anchors = panel.querySelectorAll("a[href]");
  // No need to trap focus
  if (!anchors.length) return;

  // Move focus to first anchor element
  const first = anchors.item(0);
  first.focus();

  const trapListener = createTrapListener(anchors, panel, dfn);
  panel.addEventListener("keydown", trapListener);

  // Hiding the panel releases the trap
  const mo = new MutationObserver(records => {
    const [record] = records;
    const target = /** @type HTMLElement */ (record.target);
    if (target.hidden) {
      panel.removeEventListener("keydown", trapListener);
      mo.disconnect();
    }
  });
  mo.observe(panel, { attributes: true, attributeFilter: ["hidden"] });
}

/**
 *
 * @param {NodeListOf<HTMLAnchorElement>} anchors
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function createTrapListener(anchors, panel, dfn) {
  const lastIndex = anchors.length - 1;
  let currentIndex = 0;
  return event => {
    switch (event.key) {
      // Hitting "Tab" traps us in a nice loop around elements.
      case "Tab": {
        event.preventDefault();
        currentIndex += event.shiftKey ? -1 : +1;
        if (currentIndex < 0) {
          currentIndex = lastIndex;
        } else if (currentIndex > lastIndex) {
          currentIndex = 0;
        }
        anchors.item(currentIndex).focus();
        break;
      }

      // Hitting "Enter" on an anchor releases the trap.
      case "Enter":
        hidePanel(panel);
        break;

      // Hitting "Escape" returns focus to dfn.
      case "Escape":
        hidePanel(panel);
        dfn.focus();
        return;
    }
  };
}

/** @param {HTMLElement} panel */
function hidePanel(panel) {
  if (!panel) return;
  panel.hidden = true;
  panel.classList.remove("docked");
}
})()</script><div class="sidelabel">Logius Standard - Draft</div><script src="https://gitdocumentatie.logius.nl/publicatie/respec/fixup.js"></script></body></html>